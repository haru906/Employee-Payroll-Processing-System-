<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	<munit:config name="employee_payroll_processing_system-test-suite.xml" />
	<munit:test name="getEmployeesFlowTest-suite.xml" doc:id="7a5fc693-8f93-438d-a0cc-83ffef2e003c" description="Test">
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="4fd95476-ea65-4e5e-9ead-ee76ffc5ab19" processor="db:select">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="6bb9829c-14ef-4b9e-8ecf-f113c1fda110" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[[&#10;    {&#10;        "emp_id": 101,&#10;        "name": "John Doe",&#10;        "department": "IT",&#10;        "base_salary": 5000&#10;    },&#10;    {&#10;        "emp_id": 102,&#10;        "name": "Jane Smith",&#10;        "department": "HR",&#10;        "base_salary": 4500&#10;    },&#10;    {&#10;        "emp_id": 103,&#10;        "name": "Alan Brown",&#10;        "department": "Finance",&#10;        "base_salary": 5500&#10;    },&#10;    {&#10;        "emp_id": 104,&#10;        "name": "Eva Green",&#10;        "department": "Sales",&#10;        "base_salary": 4000&#10;    },&#10;    {&#10;        "emp_id": 105,&#10;        "name": "Raj Patel",&#10;        "department": "IT",&#10;        "base_salary": 6000&#10;    }&#10;]]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow-ref to get:\employees:employee_payroll_processing_system-config" doc:id="e9e36866-f479-42a2-9e82-e3ccc2981413" name="get:\employees:employee_payroll_processing_system-config"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert expression" doc:id="13295940-c13f-4363-a5cc-b674d9126b95" >
				<munit-tools:that ><![CDATA[#[import * from dw::test::Asserts 
 ---
payload must beArray()]]]></munit-tools:that>
			</munit-tools:assert>
		</munit:validation>
	</munit:test>
	<munit:test name="getPayrollReportFlowTest-suite" doc:id="947c21f1-199e-43b0-954e-8f61443d5808" description="Test">
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="6bc94d95-da6d-4230-ac7e-703f5248c4b5" processor="db:select">
			<munit-tools:with-attributes>
				<munit-tools:with-attribute whereValue="6bb9829c-14ef-4b9e-8ecf-f113c1fda110" attributeName="doc:id" />
			</munit-tools:with-attributes>
			<munit-tools:then-return>
				<munit-tools:payload value='#[[&#10;  {&#10;    "emp_id": 101,&#10;    "name": "John Doe",&#10;    "department": "IT",&#10;    "gross_salary": 5000.00,&#10;    "tax_amount": 750.00,&#10;    "net_salary": 4250.00,&#10;    "month": "August"&#10;  }&#10;]]' />
			</munit-tools:then-return>
		</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow-ref to get:\reports\(month):employee_payroll_processing_system-config" doc:id="c95c4242-780e-40de-a901-071aa685a751" name="get:\reports\(month):employee_payroll_processing_system-config"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="49226041-20ed-473d-be2b-07d92fbd2d02" expression="#[payload[0].empId == 101]" is="#[MunitTools::notNullValue()]"/>
		</munit:validation>
	</munit:test>
	<munit:test name="employee_payroll_processing_system-test-suite" doc:id="a50dab80-4a75-40d6-afa4-9849daba90fc" description="Test">
		<munit:execution >
			<flow-ref doc:name="Flow-ref to post:\payroll:application\json:employee_payroll_processing_system-config" doc:id="f71e5cfe-b00f-496e-96a8-0e216d25cf79" name="post:\payroll:application\json:employee_payroll_processing_system-config"/>
		</munit:execution>
	</munit:test>


</mule>
